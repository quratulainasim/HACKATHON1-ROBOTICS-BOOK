# API Contract: Authentication System

## Overview
This API provides secure authentication services for the Docusaurus frontend. All authentication operations are handled by the Node.js backend, with the frontend consuming secure API endpoints. No authentication secrets are ever exposed to the client-side application.

## Base URL
`https://api.auth-system.example.com/v1` or `http://localhost:3001/v1` for development

## Authentication
All endpoints (except `/register` and `/login`) require a valid session token in the Authorization header:
```
Authorization: Bearer {session_token}
```

## Endpoints

### POST /auth/register
Register a new user account

**Request**:
```json
{
  "email": "user@example.com",
  "password": "securePassword123",
  "name": "John Doe"
}
```

**Response (Success)**:
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "uuid-string",
      "email": "user@example.com",
      "name": "John Doe",
      "email_verified": false
    },
    "session": {
      "token": "jwt-token-string",
      "expires_at": "2024-12-31T23:59:59Z"
    }
  }
}
```

**Response (Error)**:
```json
{
  "success": false,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Email already exists or invalid format"
  }
}
```

### POST /auth/login
Authenticate user with credentials

**Request**:
```json
{
  "email": "user@example.com",
  "password": "securePassword123"
}
```

**Response (Success)**:
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "uuid-string",
      "email": "user@example.com",
      "name": "John Doe",
      "email_verified": true
    },
    "session": {
      "token": "jwt-token-string",
      "refresh_token": "refresh-token-string",
      "expires_at": "2024-12-31T23:59:59Z"
    }
  }
}
```

### POST /auth/logout
End current user session

**Headers**:
```
Authorization: Bearer {valid_session_token}
```

**Response**:
```json
{
  "success": true,
  "message": "Successfully logged out"
}
```

### GET /auth/me
Get current user profile information

**Headers**:
```
Authorization: Bearer {valid_session_token}
```

**Response**:
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "uuid-string",
      "email": "user@example.com",
      "name": "John Doe",
      "avatar_url": "https://example.com/avatar.jpg",
      "email_verified": true,
      "created_at": "2024-01-01T00:00:00Z",
      "last_login": "2024-01-01T12:00:00Z"
    }
  }
}
```

### POST /auth/forgot-password
Initiate password reset process

**Request**:
```json
{
  "email": "user@example.com"
}
```

**Response**:
```json
{
  "success": true,
  "message": "Password reset email sent if account exists"
}
```

### POST /auth/reset-password
Complete password reset process

**Request**:
```json
{
  "reset_token": "password-reset-token",
  "new_password": "newSecurePassword123"
}
```

**Response**:
```json
{
  "success": true,
  "message": "Password reset successfully"
}
```

### GET /auth/verify-email
Verify user's email address

**Request**:
```json
{
  "verification_token": "email-verification-token"
}
```

**Response**:
```json
{
  "success": true,
  "message": "Email verified successfully"
}
```

### POST /auth/change-password
Change user's password

**Headers**:
```
Authorization: Bearer {valid_session_token}
```

**Request**:
```json
{
  "current_password": "currentPassword123",
  "new_password": "newSecurePassword123"
}
```

**Response**:
```json
{
  "success": true,
  "message": "Password changed successfully"
}
```

## Error Responses
All error responses follow this format:
```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "Human-readable error message",
    "details": "Additional error details if applicable"
  }
}
```

### Common Error Codes
- `VALIDATION_ERROR`: Input validation failed
- `AUTHENTICATION_FAILED`: Invalid credentials
- `AUTHORIZATION_FAILED`: Insufficient permissions
- `RESOURCE_NOT_FOUND`: Requested resource does not exist
- `RATE_LIMIT_EXCEEDED`: Too many requests from same IP
- `SESSION_EXPIRED`: Authentication token has expired
- `INTERNAL_ERROR`: Server-side error occurred

## Security Headers
All responses include appropriate security headers:
- Strict-Transport-Security for HTTPS enforcement
- Content-Security-Policy to prevent XSS
- X-Content-Type-Options to prevent MIME-type confusion
- X-Frame-Options to prevent clickjacking
- X-XSS-Protection for legacy browsers

## Rate Limiting
- 100 requests per hour per IP for authenticated endpoints
- 10 requests per hour per IP for authentication endpoints
- Exponential backoff for failed authentication attempts